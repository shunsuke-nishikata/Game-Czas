<main class="row">
  <div class="body body__mypage--edit">
    <div class="heading">
      <% if @event.user == current_user %>
        <h3 class="heading__title--main">My Events ++</h3>
        <h3 class="heading__title--ja">イベント詳細ページ</h3>
      <% else %>
        <h3 class="heading__title--main"><%= @event.user.name %> Events ++ </h3>
        <h3 class="heading__title--ja"><%= @event.user.name %>さんのイベントページ</h3>
      <% end %>
      
    </div>
    <div class="heading__border">
      <span class="border-title">イベントを確認しよう！</span>
    </div>
    <div class="content">
      <div class="content__field--event">
        <div class="content__fields">
          <% if @event.user == current_user %>
            <h2 class="content__fields--heading">My Event</h2>
          <% else %>
            <h2 class="content__fields--heading"><%= @event.user.name %> Event details</h2>
          <% end %>
          <div class="event__area">
            <table class="table table-borderless ">
              <tbody>
                <tr>
                  <th scope="row"></th>
                  <td></td>
                </tr>
                <tr>
                  <th scope="row">イベント名</th>
                  <td class="nomal-font font-sm"><%= @event.event_name %></td>
                </tr>
                <tr>
                  <th scope="row">イベント日</th>
                  <td class="nomal-font font-sm"><%= @event.event_data.to_s(:date_jp) %></td>
                </tr>
                <tr>
                  <th scope="row">開催時間〜終了時間</th>
                  <td class="nomal-font font-sm">
                    <%= @event.starting_time.to_s(:time)  %>
                    &emsp;~ &emsp;
                    <%= @event.ending_time.to_s(:time) %>
                  </td>
                </tr>
                <tr>
                  <th scope="row">料金</th>
                  <td class="nomal-font"><%= @event.place %>円</td>
                </tr>
                <tr>
                  <th scope="row">開催予定場所</th>
                  <td class="nomal-font"><%= @event.game_location%></td>
                </tr>
              </tbody>
            </table>
            <% if @event.user != current_user %>
              <%= form_with model: @event, url: event_path(@event), local: true do |f| %>
                <% if @event.is_request == false %>
                  <%= f.hidden_field :is_request, value: true %>
                  <%= f.submit "オファーする！", class: "btn btn-primary" %>
                <% else %>
                  <%= f.hidden_field :is_request, value: false %>
                  <%= f.submit "オファー済み！", class: "btn btn-primary" %>
                <% end %>
              <% end %>
            <% end %>
            
            <% if @event.user == current_user %>
              <div class="event__area--buttons">
                <%= link_to "編集", edit_event_path(@event), class: "mypage-button btn btn-info "%>
                <%= link_to "削除", event_path(@event), method: :delete, class: "mypage-button btn btn-danger"%>
              </div>
            <% end %>
            <div class="heading__border">
              <span class="border-title">コメントはこちらから！</span>
            </div>
<!--コメント表示領域-->
            <% @event.event_comments.each do |event_comment| %>
              <li class="comment">
                <div class="comment-body bb">
                  <div class="comment-avatar">
                    <div class="avatar">
                      <%#= image_tag('sample-author1.jpg', style: "width: 60px; height: 60px;") %>
                    </div>
                  </div>
                  <div class="comment-text">
                    <div class="comment-author clearfix">
                      <a href="#" class="link-author"><%= event_comment.user.name %></a>
                      <span class="comment-meta">
                        <span class="comment-date"><%= event_comment.created_at.strftime('%Y/%m/%d') %></span>
                      </span>
                    </div>
                    <div class="comment-entry"><%= event_comment.comment %></div>
                    <% if event_comment.user == current_user %>
                      <div>
                        <%= link_to "削除", event_event_comment_path(event_comment.event, event_comment), method: :delete, class: "btn btn-danger pull-right" %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </li>
            <% end %>
            <% if @event.likes_by?(current_user) %>
            
                <%= link_to event_like_path(@event), method: :delete do %>
                  <i class="fas fa-heart" style="color: red;"></i>
                <% end %>
                <%= @event.likes.count %> いいね
              
              <% else %>
              
                <%= link_to event_likes_path(@event), method: :post do %>
                  <i class="far fa-heart" style="color: black;"></i>
                <% end %>
                <%= @event.likes.count %> いいね
              
            <% end %>
            <i class="far fa-comments" style="color: black;"></i>
            <%= @event.event_comments.count %>コメント
<!--コメントフォーム領域-->
            <%= form_with(model:[@event, @event_comment],url:  event_event_comments_path(@event), local: true) do |f| %>
              <div class="row">
                <div class="col-sm-12">
                  <%= f.text_area :comment, rows:'5', class: "form-control",placeholder: "コメントをここに" %>
                </div>
              </div>
              <%= f.submit "送信する", class: "btn btn-lg btn-base-1 mt-20 pull-right" %>
            <% end %>
        </div>
        </div>
      </div>
    </div>
  </div>
  <%= render 'layouts/sidebar' %>
</main>